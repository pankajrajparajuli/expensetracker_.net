@page "/signup"
@inject IDataService DataService
@inject NavigationManager Nav

<h3 class="text-center mb-4">Sign Up</h3>

<div class="container" style="max-width: 400px;">
    <div class="form-group mb-3">
        <label>Username</label>
        <input class="form-control" @bind="Username" />
    </div>

    <div class="form-group mb-3">
        <label>Password</label>
        <input type="password" class="form-control" @bind="Password" />
    </div>

    <div class="form-group mb-3">
        <label>Preferred Currency</label>
        <input class="form-control" @bind="Currency" />
    </div>

    <button class="btn btn-primary w-100" @onclick="RegisterUser">Create Account</button>

    @if (!string.IsNullOrWhiteSpace(Message))
    {
            <div class="alert alert-info mt-3">@Message</div>
    }
</div>

@code {
    private string Username = "";
    private string Password = "";
    private string Currency = "USD";
    private string Message = "";

    private async Task RegisterUser()
    {
        if (string.IsNullOrWhiteSpace(Username) || string.IsNullOrWhiteSpace(Password))
        {
            Message = "Username and Password are required.";
            return;
        }

        var user = new UserSettings
            {
                Username = Username,
                Password = Password,
                Currency = Currency,
                IsLoggedIn = true
            };

        await DataService.SaveUserSettingsAsync(user);
        Nav.NavigateTo("/dashboard", forceLoad: true);
    }
}